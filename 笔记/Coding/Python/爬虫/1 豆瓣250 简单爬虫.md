
```python
import os
import re
import requests
import pandas as pd
from bs4 import BeautifulSoup

def get_top250(url = "https://movie.douban.com/top250"):
     head = {'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
     'Referer':url,
     'Connection':'keep-alive'}
     data = []
     for i in range(0,250,25):
          response = requests.get(f"{url}?start={i}&filter=", headers = head)
          if response.ok:
               soup = BeautifulSoup(response.text, "html.parser")
               movies = soup.find_all('div', class_='item')
               for movie in movies:
	                # 查找匹配1
                    title = movie.find('span', class_= 'title').string
                    # 查找匹配2
                    rank = movie.find('span', class_ = 'rating_num').string
                    # 防止quote为空报错
                    quote_element = movie.find('span', class_='inq')
                    quote = quote_element.string if quote_element else None
                    # 正则匹配1
                    year_match = re.search(r'\b\d{4}\b', str(movie))
                    year = year_match.group() if year_match else None
					# 正则匹配2
                    director_match = re.search(r'导演:\s*([^\s]+)\s*', str(movie))
                    director = director_match.group(1) if director_match else None
					# 去除 / 后的外语名、别名
                    if not title.startswith(" / "):
                         data.append((title,year,rank,director,quote))
          else:
               pass
     columns = ['电影名称','年份', '评分', '导演', '简评']
     df = pd.DataFrame(data, columns=columns)
     return df

if __name__ == '__main__':
     # Call the function and save the result to Excel
     result_df = get_top250()
     result_df.to_excel('Top250.xlsx', index=False)
```
