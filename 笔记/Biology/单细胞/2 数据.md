Seurat单细胞分析流程主要就是以下十句代码

```R
pbmc.counts <- Read10X(data.dir = "data/filtered_gene_bc_matrices/hg19/")
pbmc <- CreateSeuratObject(counts = pbmc.counts)
pbmc <- NormalizeData(object = pbmc)
pbmc <- FindVariableFeatures(object = pbmc)
pbmc <- ScaleData(object = pbmc)
pbmc <- RunPCA(object = pbmc)
pbmc <- FindNeighbors(object = pbmc)
pbmc <- FindClusters(object = pbmc)
pbmc <- RunTSNE(object = pbmc)
DimPlot(object = pbmc, reduction = "tsne")
```

从数据读取开始

# 数据

## 三文件 

使用Seurat包进行分析，它能够处理和分析来自不同平台(包括10x Genomics、DroNc-seq、Smart-seq等)的scRNA-seq数据。

最常见的是从包含`matrix.mtx`（原始counts），`barcodes.tsv`（细胞信息），`genes.tsv`（基因信息）三个文件的文件夹读取数据。

```R
xxx.data <- Read10X(data.dir = "data/")
xxx <- CreateSeuratObject(xxx.data, project = "name", min.cells = 3, min.features = 200) # mincell为初步过滤，基因至少在3个细胞中表达；minfeature指细胞至少表达多少个基因才会被保留。
```

+ barcodes.tsv 和 genes.tsv，就是表达矩阵的行名和列名；
+ matrix.mtx 文件是3列，第一列是行号，第二列是列号，第三列是基因表达量，而且仅仅是列出有表达量的基因即可，即仅仅是显示非0值。

```R
$head barcode.tsv 
AAACATACAACCAC-1
AAACATTGAGCTAC-1
AAACATTGATCAGC-1
AAACCGTGCTTCCG-1
AAACCGTGTATGCG-1

$head genes.tsv
ENSG00000243485	MIR1302-10
ENSG00000237613	FAM138A
ENSG00000186092	OR4F5
ENSG00000238009	RP11-34P13.7
ENSG00000239945	RP11-34P13.8

$head matrix.mtx
%%MatrixMarket matrix coordinate real general
%
32738 2700 2286884
32709 1 4
32707 1 1
```

## 仅有一个稀疏矩阵

```R
matrix_data <- read.table("single_cell_datamatrix.txt", sep="\t", header=T, row.names=1)
dim(matrix_data) # 获取矩阵的维数（x行y列），y为细胞数
seurat_obj <- CreateSeuratObject(counts = matrix_data)
```

## RDS文件

rds是二进制文件，直接用`readRDS`函数读取

```R
rm(list = ls())
pbmc <- readRDS("panc8.rds")
saveRDS(pbmc,"pbmc.rds")
```

```R
str(pbmc)
(out <- capture.output(str(pbmc)))
out2 <- str(pbmc)  %>%  
  capture.output(.) %>% 
  gsub(
    pattern = "\\.\\. ",
    replacement = "#",
    x = .
  ) %>% 
  gsub(
    pattern = "\\.\\.@",
    replacement = "# ",
    x = .
  ) %>% 
  gsub(pattern="^\\s+#",replace="#")

mindr::mm(
  from = out2,
  input_type = "markdown",
  output_type = "widget",
  root = "Seurat"
)
```


